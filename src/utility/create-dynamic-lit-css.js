const path = require("path");
const fs = require("fs");
const componentDirectory = process.cwd();
const componentDistDirectory = path.join(componentDirectory, "dist");
const distFiles = fs.readdirSync(componentDistDirectory);
const cssDistFiles = distFiles.filter(
  (filename) => path.parse(filename).ext === ".css"
);
const litCssExportString = `// DO NOT EDIT THIS FILE DIRECTLY
import { css, unsafeCSS } from "lit-element";
export default css\`
  \${unsafeCSS(\`INJECTCSSHERE\`)}\`;`;
cssDistFiles.forEach((filename) => {
  const fullPathToFile = path.join(componentDistDirectory, filename);
  const { name } = path.parse(filename);
  const cssContents = fs.readFileSync(fullPathToFile, "utf-8");
  const newFileName = `${name}.styles.js`;
  const fullPathToNewFile = path.join(componentDistDirectory, newFileName);
  const newFileContents = litCssExportString.replace(
    "INJECTCSSHERE",
    cssContents
  );
  fs.writeFileSync(fullPathToNewFile, newFileContents);
});